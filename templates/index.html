{% extends "layout.html" %} {% block content %} {% if session.user_id %}
<div class="index">
  <div class="toolbar">
    <div class="dropdown">
      <div class="dropdown-box">Lisää viite</div>
      <ul class="dropdown-content">
        <li>
          <a href="/addbib">BibTex -muodossa tai DOI -tunnisteella</a>
        </li>
        {% for ref in references %}
        <li>
          <a href="/add/{{ ref[0] }}">{{ ref[1] }}</a>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>

  {% if added_references %}
  <ul>
    {% for ref in added_references %}
    <li class="reference">
      <div>
        <span class="ref-id">{{ ref.reference_id }}</span>
        <span class="ref-author">
          {% if 'author' in ref %} {{ ref.author }} {% else %} {{ ref.editor}}
          {% endif %}
        </span>
      </div>

      <div>
        <span class="ref-title">
          {% if 'booktitle' in ref %} {{ ref.booktitle }} {% else %} {{
          ref.title }} {% endif %}
        </span>

        <span class="ref-time">
          {% if 'year' in ref or 'month' in ref %} {{ ref.year }} {{ ref.month
          }} {% endif %}
        </span>
      </div>

      <details>
        <summary>Lisää tietoja</summary>
        <div>
          {% for field in ref %} {% if field not in ["id", "user_id"] %} {{
          field }}: {{ ref[field] }} <br />
          {% endif %} {% endfor %}
        </div>
      </details>
    </li>
    {% endfor %}
  </ul>
  <div>
    <button onclick="location.href = '/download-file'">
      Lataa BibTex -tiedosto
    </button>
  </div>
  {% else %}
  <p>Et ole lisännyt vielä yhtään viitettä.</p>
</div>

{% endif %} {% endif %} {% endblock %}
